<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs title="Issues from jira by issueStatus"
                 height="300"
                 description="Drill Down Enabled piechart for showing issues by issueStatus from Jira"
                 tags="drill-down">
        <Require feature="dynamic-height"/>
        <Require feature="pubsub-2"/>
    </ModulePrefs>
    <Content type="html">
        <![CDATA[
        <html>
        <head>
            <title>
                Issues and Sonar Dashboard Gadget
            </title>

            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1">

            <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
            <link href="/portal/libs/bootstrap_3.3.5/css/daterangepicker.css" rel="stylesheet"/>
            <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">-->
            <!--<link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">-->
            <link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>

            <style type="text/css">
                body {
                    overflow:hidden;
                }
                .sidebarInside{
                    max-height:500px !important;
                    overflow:hidden;
                    overflow-y:auto;

                }

                .left {
                    height:100vh;
                    max-height: 100vh;
                    overflow-y : scroll;
                }
                .right-scrolling-body {
                    margin-top:0px;
                    margin-bottom:10px;
                    height: 830px;
                    overflow-y: scroll;
                    position: relative;
                }

            </style>
            <style type="text/css">
                .demo i {
                    position: relative; bottom: 10px; right: 24px; top: auto; cursor: pointer;
                }
            </style>
        </head>

        <body>

        <div class="container-fluid" id="contents" >
            <div class="row" style="margin: 5px">
                <br><br>
                <div class="col-xs-2">
                    <div class="row" style="margin-top:15px;">
                        <div class="col-xs-6">
                            <div class="row">
                                <div class="col-xs-2"><div style="background-color:#F4A94E; height:15px; width:15px;"></div></div>
                                <div class="col-xs-10"><p style="margin-left:18px; margin-top:-19px;">Issues</p></div>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="row">
                                <div class="col-xs-2"><div style="background-color:#4BC2DE; height:15px; width:15px;"></div></div>
                                <div class="col-xs-10"><p style="margin-left:18px; margin-top:-19px;">Sonar</p></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-10" style="padding-top:15px">
                    <div id="componentChoice" class="row" style=""></div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <div id="fullDiv" style="background-color:#FFFFFF; height:auto;">
                        <div class="col-xs-12" style="">
                            <div class="row">
                                <div class="col-xs-2" style="">
                                    <!-- Tab panes -->
                                    <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="home" style="">
                                            <div  id="area" class="panel-group" style=""></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="right-scrolling-body col-xs-10 col-md-10" style="border: solid #a9a9a9 1px">
                                    <div class="row">
                                        <div class=" col-xs-12 col-md-12">

                                            <h3>Issues</h3>
                                            <div class="card" style="background-color:#EFEEEE; padding: 15px; border: solid #a9a9a9 1px;">
                                                <div class="container-fluid" >
                                                    <div>
                                                        <h4 style="padding:10px; text-align:center">Click on the following dropdowns to change the graphs</h4>
                                                        <div class="row">
                                                            <div class="col-md-2" style="text-align:center"></div>
                                                            <div class="form-group col-md-3"  style="text-align:center">
                                                                <h4>Issue Type</h4>
                                                                <select class="form-control" id='issuetype-choice' style="width:250px; padding: 5px;">
                                                                    <option value="0">All</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-2" style="text-align:center; margin-top: 40px;">
                                                                <button  type="button" class="btn btn-default" onclick="resetIssueCharts()">
                                                                    Reset
                                                                </button>
                                                            </div>
                                                            <div class="form-group col-md-3" style="text-align:center">
                                                                <h4>Severity</h4>
                                                                <select class="form-control" id='severity-choice' style="width:250px; padding: 5px;">
                                                                    <option value="0">All</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-2" style="text-align:center"></div>
                                                        </div>
                                                        <br>
                                                    </div>
                                                </div>


                                                <div class="row" style="padding:15px;">
                                                    <div class="card col-xs-12">
                                                        <div>

                                                            <div>
                                                                <div  id="main-chart-container" class="card-block" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6" style="">
                                                        <div class="card">
                                                            <div class="card-header" id="issuetype-graph-header">
                                                                <h5>Issue Type Breakdown Chart</h5>
                                                            </div>
                                                            <div class="card-block">
                                                                <div  id="issuetype-chart-container" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <div class="card">
                                                            <div class="card-header" id="severity-graph-header">
                                                                <h5>Severity Breakdown Chart</h5>
                                                            </div>
                                                            <div class="card-block">
                                                                <div  id="severity-chart-container" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row" style="padding:15px 0px 15px 0px;">
                                                    <div class="col-xs-12" style="">
                                                        <div class="card">
                                                            <div class="card-header" id="trend-graph-header">
                                                                <div class="col-xs-4">
                                                                    <h5>Historical Trend</h5>
                                                                </div>

                                                                <!--<label class="pull-right" id="reportrange" style="padding-top : 10px; padding-right : 20px; background: #fff; cursor: pointer; #ccc;">-->
                                                                <!--<i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;-->
                                                                <!--<span></span> <b class="caret"></b>-->
                                                                <!--</label>-->
                                                                <div class="col-xs-4">
                                                                    <p style="text-align: right; margin-top:10px;">Select a Date Range:</p>
                                                                </div>
                                                                <div class="col-xs-4">
                                                                    <!--<label class="pull-right" id="reportrange" style="padding-top : 10px; padding-right : 20px; background: #fff; cursor: pointer; #ccc;">-->
                                                                    <!--<i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;-->
                                                                    <!--<span></span> <b class="caret"></b>-->
                                                                    <!--</label>-->
                                                                    <input type="text" id="reportrange" style="border:1px solid #bcb7b3; background-color: #FFFFFF; width:100%;" class="form-control">
                                                                    <i class="fa fa-calendar" style="float:right; margin-top:-12px;"></i>
                                                                </div>


                                                            </div>
                                                            <div class="card-block content-body">
                                                                <div class="container-fluid" >
                                                                    <div class="row" style="padding-left:0;">
                                                                        <div class="col-xs-6 col-md-6">
                                                                            <div class="row">
                                                                                <div class="btn-group pull-right" role="group" style="margin-top:10px; margin-right:20px;">
                                                                                    <button id="dailyBtn" type="button" class="btn btn-default" >Day</button>
                                                                                    <button id="monthlyBtn" type="button" class="btn btn-default" >Month</button>
                                                                                    <button id="quarterlyBtn" type="button" class="btn btn-default" >Quarter</button>
                                                                                    <button id="yearlyBtn" type="button" class="btn btn-default" >Year</button>
                                                                                </div>
                                                                                <div class="col-xs-10"></div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-xs-12">
                                                                            <div id="trend-chart-container" style="min-width: 310px; max-width: 1100px; height: 375px; margin: 0 auto"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- </div> -->

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class=" col-xs-12 col-md-12">

                                            <h3>Sonar</h3>
                                            <div class="card" style="background-color:#EFEEEE; padding: 15px; border: solid #a9a9a9 1px;">
                                                <div class="container-fluid" >

                                                    <div>
                                                        <h4 style="padding:10px; text-align:center">Click on the following dropdowns to change the graphs</h4>
                                                        <div class="row">
                                                            <div class="col-md-2" style="text-align:center"></div>
                                                            <div class="form-group col-md-3"  style="text-align:center">
                                                                <h4>Issue Type</h4>
                                                                <select class="form-control" id='sonar-issuetype-choice' style="width:300px; padding: 5px;">
                                                                    <option value="0">All</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-2" style="text-align:center; margin-top: 40px;">
                                                                <button type="button" class="btn btn-default" onclick="resetSonarCharts()">
                                                                    Reset
                                                                </button>
                                                            </div>
                                                            <div class="form-group col-md-3" style="text-align:center">
                                                                <h4>Severity</h4>
                                                                <select class="form-control" id='sonar-severity-choice' style="width:300px; padding: 5px;">
                                                                    <option value="0">All</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-2" style="text-align:center"></div>
                                                        </div>
                                                        <br>
                                                    </div>
                                                </div>


                                                <div class="row" style="padding:15px;">
                                                    <div class="card col-xs-12">
                                                        <div>

                                                            <div>
                                                                <div  id="main-chart-container-sonar" class="card-block" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6" style="">
                                                        <div class="card">
                                                            <div class="card-header" id="issuetype-graph-header-sonar">
                                                                <h5>Issue Type Breakdown Chart</h5>
                                                            </div>
                                                            <div class="card-block">
                                                                <div  id="issuetype-chart-container-sonar" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <div class="card">
                                                            <div class="card-header" id="severity-graph-header-sonar">
                                                                <h5>Severity Breakdown Chart</h5>
                                                            </div>
                                                            <div class="card-block">
                                                                <div  id="severity-chart-container-sonar" style="min-width: window.document.body.scrollWidth; height: window.document.body.scrollHeight - 40; margin: 0 auto"></div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row" style="padding:15px 0px 15px 0px;">
                                                    <div class="col-xs-12" style="">
                                                        <div class="card">
                                                            <div class="card-header" id="trend-graph-header-sonar">
                                                                <h5>Historical Trend</h5>
                                                                <label class="pull-right" id="reportrange" style="padding-top : 10px; padding-right : 20px; background: #fff; cursor: pointer; #ccc;">
                                                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;
                                                                    <span></span> <b class="caret"></b>
                                                                </label>
                                                            </div>
                                                            <div class="card-block content-body">
                                                                <!-- <div  id="trend-chart-container" style="min-width: window.document.body.scrollWidth; height: 375; margin: 0 auto"> -->
                                                                <!-- <h3 style="text-align:center;">Currently no data to show</h3> -->

                                                                <div class="container-fluid">
                                                                    <div class="row" style="padding-left:0;">
                                                                        <div class="col-xs-6 col-md-6">
                                                                            <div class="row">
                                                                                <div class="btn-group pull-right" role="group" style="margin-top:10px; margin-right:20px;">
                                                                                    <button id="dailyBtnSonar" type="button" class="btn btn-default" >Day</button>
                                                                                    <button id="monthlyBtnSonar" type="button" class="btn btn-default" >Month</button>
                                                                                    <button id="quarterlyBtnSonar" type="button" class="btn btn-default" >Quarter</button>
                                                                                    <button id="yearlyBtnSonar" type="button" class="btn btn-default" >Year</button>
                                                                                </div>
                                                                                <div class="col-xs-10"></div>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-xs-12">
                                                                            <div id="trend-chart-container-sonar" style="min-width: 310px; max-width: 1100px; height: 375px; margin: 0 auto"></div>
                                                                        </div>
                                                                    </div>

                                                                    <!--<div class="row pull-right" style="padding-left:0">-->

                                                                    <!--<div class="col-xs-12 btn-group pull-right">-->

                                                                    <!--<button id="dailyBtnSonar" type="button" class="btn btn-info" autofocus="autofocus">Daily</button>-->
                                                                    <!--<button id="monthlyBtnSonar" type="button" class="btn btn-info">Monthly</button>-->
                                                                    <!--<button id="quarterlyBtnSonar" type="button" class="btn btn-info">Quarterly</button>-->
                                                                    <!--<button id="yearlyBtnSonar" type="button" class="btn btn-info">Yearly</button>-->
                                                                    <!--</div>-->

                                                                    <!--</div>-->
                                                                    <!--<div class="row">-->
                                                                    <!--<div class="col-xs-12">-->
                                                                    <!--<div id="trend-chart-container-sonar" style="min-width: 310px; max-width: 1100px; height: 375px; margin: 0 auto"></div>-->
                                                                    <!--</div>-->
                                                                    <!--</div>-->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--   Core JS Files   -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <!--<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

        <script type="text/javascript" src="js/moment.js"></script>
        <script type="text/javascript" src="js/daterangepicker.js"></script>

        <!-- Highcharts JS-->
        <script src="code/highcharts.js"></script>
        <script src="code/modules/data.js"></script>
        <script src="code/modules/drilldown.js"></script>

        <!--Custom JS-->
        <script src="js/dashboard.js"></script>
        <script type="text/javascript" src="js/data.js"></script>
        <!--<script type="text/javascript" src="js/app.js"></script>-->
        <script type="text/javascript" src="js/app1.js"></script>
        <script type="text/javascript" src="js/mapping.js"></script>
        <!--<script type="text/javascript" src="js/loadSidePane.js"></script>-->

        <script>
            <!--$( document ).ready(function() {-->
                <!--// Handler for .ready() called.-->

                <!--});-->
            <!--initCharts(response);-->
            <!--initPage();-->
            $(window).on('load', function() {
                <!--$("#contents").hide();-->
                initPage();
            });

            $(".right").scroll(function() {
                $(".daterangepicker").hide();
                $('#reportrange').blur();
            });

            $(window).resize(function() {
                $(".daterangepicker").hide();
                $('#reportrange').blur();
            });
        </script>




        <script type="text/javascript">

            var start = moment().subtract(29, 'days');
            var end = moment();
            var startDate = start.format('YYYY-MM-DD');
            var endDate = end.format('YYYY-MM-DD');

            $('input[name="daterange"]').daterangepicker();
            $('#reportrange').on('apply.daterangepicker', function(ev, picker) {

                startDate = picker.startDate.format('YYYY-MM-DD');
                endDate = picker.endDate.format('YYYY-MM-DD');
                setDate(startDate, endDate);
                console.log(startDate);
                console.log(endDate);
            });



        </script>

        <script type="text/javascript">
            $(function() {

                var start = moment().subtract(29, 'days');
                var end = moment();

                function cb(start, end) {
                    $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                }

                $('#reportrange').daterangepicker({
                    startDate: start,
                    endDate: end,
                    ranges: {
                        <!--'Today': [moment(), moment()],-->
                        <!--'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],-->
                        'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                        'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                        'This Month': [moment().startOf('month'), moment().endOf('month')],
                        'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                    }
                }, cb);

                cb(start, end);

            });

            $('#dailyBtn').click(function(){
                getIssueTrendLineHistory("day");
            });
            $('#monthlyBtn').click(function(){
                getIssueTrendLineHistory("Month");
            });
            $('#quarterlyBtn').click(function(){
                getIssueTrendLineHistory("Quarter");
            });
            $('#yearlyBtn').click(function(){
                getIssueTrendLineHistory("Year");
            });
            $('#dailyBtnSonar').click(function(){
                getSonarTrendLineHistory("day");
            });
            $('#monthlyBtnSonar').click(function(){
                getSonarTrendLineHistory("Month");
            });
            $('#quarterlyBtnSonar').click(function(){
                getSonarTrendLineHistory("Quarter");
            });
            $('#yearlyBtnSonar').click(function(){
                getSonarTrendLineHistory("Year");
            });

            $('#reportrange').on('apply.daterangepicker', function(ev, picker) {

                startDate = picker.startDate.format('YYYY-MM-DD');
                endDate = picker.endDate.format('YYYY-MM-DD');
                setDate(startDate, endDate);
                getHistoryForAll("day");
            });

        </script>




        </body>
        </html>



        ]]>
    </Content>
</Module>
